import{_ as v,j as b,a as k,T as I,s as x,k as h,o as B,l as H,B as T,c as a,F as p,e as g,m as f,u as D,h as w,i as o,t as m,f as y,d as u}from"./index-CdcUHPY5.js";const C={name:"HistoryView",methods:{goBook:b},components:{TheImage:k,TheIcon:I},setup(){const{getHistoryFromDB:_}=D,l=x([]),c=h(()=>l.value.map(t=>t.id)),n=h(()=>Object.entries(i.value.reduce((t,e)=>(t[e.date]=t[e.date]||[],t[e.date].push(e.comic),t),{})).sort((t,e)=>new Date(e[0])-new Date(t[0]))),i=x([]);return B(async()=>{l.value=await _();const t=await H(c.value);i.value=l.value.map(e=>({...e,comic:t.data.find(r=>r._id===e.id)})).sort((e,r)=>new Date(r.timestamp)-new Date(e.timestamp))}),{BASE_URL:T,populatedHistories:i,groupedHistory:n,historyIds:c}}},N={class:"relative top-40 mx-auto w-full max-w-screen-2xl min-w-[300px] px-1 text-white"},V={key:0,class:"divider divider-secondary"},$={class:"card-body text-xs text-center bg-primary rounded-b-xl py-4 px-0 font-bold font-NotoSerif"},S={class:"2xl:text-base break-all"},E={class:"text-neutral-content font-Noto"},F={key:0,class:"relative top-20 text-lg text-center font-base font-black"};function L(_,l,c,n,i,t){const e=w("TheImage"),r=w("TheIcon");return o(),a("main",N,[(o(!0),a(p,null,g(n.groupedHistory,d=>(o(),a(p,{key:d[0]},[d[1].length?(o(),a("div",V,m(d[0]),1)):f("",!0),(o(!0),a(p,null,g(d[1],s=>(o(),a("article",{key:s._id,class:"w-1/3 md:w-1/3 lg:w-1/4 xl:w-1/5 card inline-flex mb-4 px-2 md:px-3 lg:px-2 indicator align-top"},[y(e,{blur:!1,class:"cursor-pointer max-h-44 2xl:max-h-48 rounded-t-xl",src:`${n.BASE_URL}/${s._id}/${s.coverImage.chapter}/${s.coverImage.page}.webp`,onClick:R=>t.goBook(s._id)},null,8,["src","onClick"]),y(r,{type:"xmark",class:"indicator-item badge badge-error right-3 cursor-pointer fa-solid text-black"}),u("div",$,[u("span",S,m(s.name),1),u("span",E,m(s.author),1)])]))),128))],64))),128)),n.historyIds.length?f("",!0):(o(),a("h1",F," 当前未观看漫画哦 "))])}const A=v(C,[["render",L]]);export{A as default};
